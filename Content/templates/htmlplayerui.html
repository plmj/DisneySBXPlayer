<img class="toggleCompact" src="Content/Assets/compactMode.png" style="display:none"/>
<div class="asc-player-container asc-player-htmlplayer-container">
    <div class="asc-player-media-control asc-player-htmlplayer">
        <div class="asc-player-control-left">          
            <a class="asc-player-stop"><img src="Content/Assets/stop.png" /></a>
           <!-- <div class="asc-player-volume-controls">
                <a class="asc-player-audio-on"><i class="fa fa-volume-up"></i></a>
                <a class="asc-player-audio-off"><i class="fa fa-volume-off"></i></a>
                <div class="asc-player-volume-slider-controls">
                    <progress class="asc-player-volume-progress" min="0" max="100" value="0"></progress>
                    <input class="asc-player-volume-slider" type="range" step="1" min="0" max="100" value="0" />
                </div>-->
           <div class="asc-player-media-title"></div>
           <a class="asc-player-fullscreen-expand"><img src="Content/Assets/fullscreen_expand.png" /></a>
         	 <a class="asc-player-fullscreen-collapse"><img src="Content/Assets/fullscreen_collapse.png" /></a>       
        </div>
        <a class="asc-player-play"><img src="Content/Assets/play.png" /></a>
        <a class="asc-player-pause"><img src="Content/Assets/pause.png" /></a>
        <div class="asc-player-control-right">
        	<div class="asc-player-slider">
        		<div class="asc-player-time">
              <span class="asc-player-current-time">00:00:00</span>
              <span class="asc-player-duration">00:00:00</span>
	          </div>
	        	<div class="asc-player-progress-container">
	            <progress class="asc-player-progress" value="0" min="0"><span id="progress-bar"></span></progress>
	            <input class="asc-player-scrubber" type="range" step="1" value="0" />
	       		</div>
        	</div>
        	<a class="asc-player-closedcaptionicon"><img src="Content/Assets/cc.png" /></a>
        	<a class="asc-player-rewind"><img src="Content/Assets/rewind.png" /></a>   		
          <div class="asc-player-captions-audio"></div>
          <div class="asc-player-acc-menu"></div>
            <!--<div class="asc-player-quality-indicator" style="display: none;">
                <div class="asc-player-quality-hd asc-player-icon-container"><img src="Content/Assets/hdicon.png" /></div>
                <div class="asc-player-quality-bars asc-player-icon-container"><div class="asc-player-quality-bars-icon"></div></div>
            </div>
            <a class="asc-player-acc-button"><i class="fa fa-cog"></i></a>
            <div class="asc-player-acc-menu">
                <div class="asc-player-acc-menu-container">
                    <ul class="asc-player-acc-menu-left">
                        <li>
                            <label for="asc-player-acc-font-family" cdresource="label_font_family">Font Family:</label>
                            <select id="asc-player-acc-font-family" class="asc-player-acc-font-family asc-player-acc-setting">
                                <option value="Arial, Helvetica, sans-serif" cdresource="option_arial">Arial</option>
                                <option value="Verdana, Geneva, sans-serif" cdresource="option_verdana">Verdana</option>
                                <option value="&quot;Times New Roman&quot;, Times, serif" cdresource="option_times_new_roman">Times New Roman</option>
                                <option value="Georgia, serif" cdresource="option_georgia_font">Georgia</option>
                                <option value="&quot;Courier New&quot;, Monaco, monospace" cdresource="option_courier_new">Courier New</option>
                                <option value="Impact, Charcoal, sans-serif" cdresource="option_impact">Impact</option>
                            </select>
                        </li>
                        <li>
                            <label for="asc-player-acc-font-size" cdresource="label_font_size">Font Size:</label>
                            <select id="asc-player-acc-font-size" class="asc-player-acc-font-size asc-player-acc-setting">
                                <option value="0.5em" cdresource="option_small">Small</option>
                                <option value="1.0em" cdresource="option_medium">Medium</option>
                                <option value="1.5em" cdresource="option_large">Large</option>
                                <option value="2.0em" cdresource="option_extra_large">Extra Large</option>
                            </select>
                        </li>
                        <li>
                            <label for="asc-player-acc-font-style" cdresource="label_font_style">Font Style:</label>
                            <select id="asc-player-acc-font-style" class="asc-player-acc-font-style asc-player-acc-setting">
                                <option value="italic" cdresource="option_italic">Italic</option>
                                <option value="normal" cdresource="option_normal">Normal</option>
                            </select>
                        </li>
                        <li>
                            <label for="asc-player-acc-font-weight" cdresource="label_font_weight">Font Weight:</label>
                            <select id="asc-player-acc-font-weight" class="asc-player-acc-font-weight asc-player-acc-setting">
                                <option value="normal" cdresource="option_normal">Normal</option>
                                <option value="bold" cdresource="option_bold">Bold</option>
                                <option value="bolder" cdresource="option_bolder">Bolder</option>
                                <option value="lighter" cdresource="option_lighter">Lighter</option>
                            </select>
                        </li>
                        <li>
                            <label for="asc-player-acc-font-color" cdresource="label_font_color">Font Color:</label>
                            <select id="asc-player-acc-font-color" class="asc-player-acc-font-color asc-player-acc-setting">
                                <option class="asc-player-acc-option-white" value="#FFFFFF" cdresource="option_white">White</option>
                                <option class="asc-player-acc-option-black" value="#000000" cdresource="option_black">Black</option>
                                <option class="asc-player-acc-option-red" value="#FF0000" cdresource="option_red">Red</option>
                                <option class="asc-player-acc-option-green" value="#00FF00" cdresource="option_green">Green</option>
                                <option class="asc-player-acc-option-blue" value="#0000FF" cdresource="option_blue">Blue</option>
                                <option class="asc-player-acc-option-yellow" value="#FFFF00" cdresource="option_yellow">Yellow</option>
                                <option class="asc-player-acc-option-magenta" value="#FF00FF" cdresource="option_magenta">Magenta</option>
                                <option class="asc-player-acc-option-cyan" value="#00FFFF" cdresource="option_cyan">Cyan</option>
                            </select>
                        </li>
                    </ul>
                    <ul class="asc-player-acc-menu-right">
                        <li>
                            <label for="asc-player-acc-font-opacity" cdresource="label_font_opacity">Font Opacity:</label>
                            <select id="asc-player-acc-font-opacity" class="asc-player-acc-font-opacity asc-player-acc-setting">
                                <option value="0.25" cdresource="option_25_percent">25%</option>
                                <option value="0.5" cdresource="option_50_percent">50%</option>
                                <option value="0.75" cdresource="option_75_percent">75%</option>
                                <option value="1" cdresource="option_100_percent">100%</option>
                            </select>
                        </li>
                        <li>
                            <label for="asc-player-acc-drop-shadow" cdresource="label_drop_shadow">Drop Shadow:</label>
                            <select id="asc-player-acc-drop-shadow" class="asc-player-acc-drop-shadow asc-player-acc-setting">
                                <option value="0" cdresource="option_none">None</option>
                                <option value="1px 1px 1px rgba(150, 150, 150, 1)" cdresource="option_drop_shadow">Drop Shadow</option>
                                <option value="1px 1px 0px rgba(150, 150, 150, 1)" cdresource="option_raised">Raised</option>
                                <option value="-1px -1px 0 #000, 1px -1px 0 #000, -1px 1px 0 #000, 1px 1px 0 #000" cdresource="option_outline">Outline</option>
                            </select>
                        </li>
                        <li>
                            <label for="asc-player-acc-background-color" cdresource="label_background_color">Background Color:</label>
                            <select id="asc-player-acc-background-color" class="asc-player-acc-background-color asc-player-acc-setting">
                                <option class="asc-player-acc-option-white" value="#FFFFFF" cdresource="option_white">White</option>
                                <option class="asc-player-acc-option-black" value="#000000" cdresource="option_black">Black</option>
                                <option class="asc-player-acc-option-red" value="#FF0000" cdresource="option_red">Red</option>
                                <option class="asc-player-acc-option-green" value="#00FF00" cdresource="option_green">Green</option>
                                <option class="asc-player-acc-option-blue" value="#0000FF" cdresource="option_blue">Blue</option>
                                <option class="asc-player-acc-option-yellow" value="#FFFF00" cdresource="option_yellow">Yellow</option>
                                <option class="asc-player-acc-option-magenta" value="#FF00FF" cdresource="option_magenta">Magenta</option>
                                <option class="asc-player-acc-option-cyan" value="#00FFFF" cdresource="option_cyan">Cyan</option>
                            </select>
                        </li>
                        <li>
                            <label for="asc-player-acc-background-opacity" cdresource="label_background_opacity">Background Opacity:</label>
                            <select id="asc-player-acc-background-opacity" class="asc-player-acc-background-opacity asc-player-acc-setting">
                                <option value="0" cdresource="option_0_percent">0%</option>
                                <option value="0.25" cdresource="option_25_percent">25%</option>
                                <option value="0.5" cdresource="option_50_percent">50%</option>
                                <option value="0.75" cdresource="option_75_percent">75%</option>
                                <option value="1" cdresource="option_100_percent">100%</option>
                            </select>
                        </li>
                    </ul>
                    <div class="asc-player-acc-menu-bottom">
                        <a type="button" class="asc-player-acc-reset" cdresource="reset_text">Reset</a>
                        <a type="button" class="asc-player-acc-close" cdresource="close_text">Close</a>
                    </div>
                </div>
            </div>-->
            
        </div>
    </div>
    <div class="asc-player-message-box" style="display: none;">
        <div class="asc-player-message-box-message-container">
            <span class="asc-player-message-box-message">Message text goes here</span>
        </div>
        <div class="asc-player-message-box-button-container">
            <a class="asc-player-message-box-ok-button" style="display: none;"><span cdresource="ok">OK</span></a>
            <a class="asc-player-message-box-cancel-button" style="display: none;"><span cdresource="cancel">Cancel</span></a>
        </div>
    </div>
    <div class="asc-player-internal-spinner" style="display: none"><i class="fa fa-spinner fa-spin"></i></div>
</div>
<script type="text/javascript">

		window.ascendon.htmlplayer.uiController.toggleCompact = function(){
			$('#player').toggleClass('compact');
		};
    $(document).on('click','.toggleCompact',function(){
    	$('#player').toggleClass('compact');
    });
    $(document).on('click','.asc-player-rewind',function(){
    	ascendon.htmlplayer.uiController.getPlayer().seek($('.asc-player-progress').val() - 15);
    });
    /*
      ascendon.htmlplayer.events.on('htmlplayer.unloaded', window.ascendon.SampleController.onUnloaded);
	    ascendon.htmlplayer.events.on('htmlplayer.updatecontentprogresssuccess', window.ascendon.SampleController.onUpdateContentProgressSuccess);
	    ascendon.htmlplayer.events.on('htmlplayer.updatecontentprogresserror', window.ascendon.SampleController.onUpdateContentProgressError);
	    ascendon.htmlplayer.events.on('htmlplayer.playbackended', window.ascendon.SampleController.onPlaybackEnded);
	    ascendon.htmlplayer.events.on('htmlplayer.playerstatechanged', window.ascendon.SampleController.onPlayerStateChanged); // Buffering
	    ascendon.htmlplayer.events.on('htmlplayer.initialized', window.ascendon.SampleController.onInitialized);
	    ascendon.htmlplayer.events.on('htmlplayer.readytoplaycompleted', function() {
	        
	    });
	    ascendon.htmlplayer.events.on('htmlplayer.unsupportedaudiocodecfound', function(e, data) {
	        console.log('Unsupported codec: ' + data.codec);
	        _stop();
	        if (!$('#showMessages').is(':checked')) {
	            _unload();
	        }
	    });
	    ascendon.htmlplayer.events.on('htmlplayer.messageboxbeforeshow', function() {
	        $('.asc-player-htmlplayer').css('visibility', 'hidden');
	    });
	    ascendon.htmlplayer.events.on('htmlplayer.unsupportedaudiocodecfoundokclicked', function() {
	        _unload();
	    });
	    ascendon.htmlplayer.events.on('htmlplayer.texttrackselected', function(e, textTrack) {
	        console.log('Requesting text track: ' + textTrack.language + ' - track ID: ' + textTrack.trackid);
	    });
	    ascendon.htmlplayer.events.on('htmlplayer.texttrackchanged', function(e, textTrack) {
	        console.log('Text track ' + textTrack.label + ' changed successfully');
	    });
	    ascendon.htmlplayer.events.on('htmlplayer.texttrackchangedunavailable', function(e, textTrack) {
	        console.log('Unable to load text track: ' + textTrack.label + ' - the track is unavailable');
	    });
	    ascendon.htmlplayer.events.on('htmlplayer.texttrackchangederror', function(e, data) {
	        console.log('Unable to load text track: ' + data.language + (data.error ? ' - error: ' + data.error : ''));
	    });
	    ascendon.htmlplayer.events.on('htmlplayer.error', function(event, data){console.log(data);});  
    */
   
	// Support manifest switching
	(function (window, $, ascendon) {
		ascendon.service.settings.configure(
		{
		    systemId: env.SystemId,
		    channelId: env.ChannelId,
		    apiUrl: env.ServiceURL,
		    metadataUrl: env.ServiceURL,
		    language: 'en-US'
		});
		ascendon.service.settings.sessionId = StorefrontInternalAPI._initParams['SessionId'];
		window.playerController = new function() {
			var _uiController = null,
		  _svc = ascendon.service,
		  viewContent = function(mediaId){
		  	_svc.settings.configure({
		      systemId: env.SystemId,
		      channelId: env.ChannelId,
		      apiUrl: env.ServiceURL,
		      metadataUrl: env.MetadataURL,
		      deviceType: 4,
		      language: 'en-US'
		    });
		    var viewContentRequest = {
					ProductId: StorefrontInternalAPI._initParams.ProductIdToPlay,
	        PricingPlanId: StorefrontInternalAPI._initParams.PricingPlanIdToPlay,
					MediaId: mediaId
				};
		    //Sample use of the Ascendon service api calls. 
				_svc.subscriber.content.viewContent(viewContentRequest).done(function(result) {		
					var contentUrl = result.ContentUrl.replace(/http:/g,'https:'),
					token = result.LicenseRequestToken,
					mediaId = result.MediaId,
					reference = result.ViewContentReference,
					sideLoadedCaptions = [];
					$.cd.getMediaInfo(mediaId, function (mediaItem) {
	           if (mediaItem.ClosedCaptions && mediaItem.ClosedCaptions.ClosedCaptionSettings && mediaItem.ClosedCaptions.ClosedCaptionSettings.length > 0) {
	              for (var caption in mediaItem.ClosedCaptions.ClosedCaptionSettings) {
	              		mediaItem.ClosedCaptions.ClosedCaptionSettings[caption].Url = mediaItem.ClosedCaptions.ClosedCaptionSettings[caption].Url.replace("http", "https");
	                  sideLoadedCaptions.push({
	                      language: mediaItem.ClosedCaptions.ClosedCaptionSettings[caption].Language,
	                      url: mediaItem.ClosedCaptions.ClosedCaptionSettings[caption].Url
	                  });
	              }
	          }
	          var data = JSON.parse(decodeURIComponent(StorefrontInternalAPI._initParams.viewproductcontentjson));
	          data.ContentItemId = mediaId;
	          data.ContentURL = contentUrl;
	          data.LicenseRequestToken = token;       
	          data.ViewContentReference = reference;
	          data.ProgressSeconds = $('.asc-player-progress').val(); 
	          StorefrontInternalAPI._initParams.viewproductcontentjson = encodeURIComponent(JSON.stringify(data));
	          StorefrontInternalAPI._extension.embedApplication();
	        });
					
				});
		  };
			return{
		  	viewContent: viewContent
		  };
		}();
	})(window, window.jQuery, window.ascendon);
</script>
